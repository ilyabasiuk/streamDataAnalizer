<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.x.axis path {
  display: none;
}

.line {
  fill: none;
  stroke: steelblue;
}
.dn {
  display: none;
}
svg {
  float: left;
}
</style>
<body>
<script src="http://d3js.org/d3.v3.js"></script>
<script src= "https://rawgit.com/ZJONSSON/3918369/raw/083db7b5b1b1549a5c6b055e63138a9e802b10e5/d3.legend.js"></script>
<script src="streamDataAnalyzer.js"></script>
<script>
var data = [{"bAE7":22.791,"timeStamp":1409056110276},{"bAE7":3.201,"timeStamp":1409056127706},{"bAE7":10.286,"timeStamp":1409056235129},{"bAE7":8.9,"timeStamp":1409056266369},{"bAE7":3.698,"timeStamp":1409056360164},{"bAE7":14.104,"timeStamp":1409056455911},{"bAE7":5.497,"timeStamp":1409056486080},{"bAE7":17.209,"timeStamp":1409056578008},{"bAE7":8.212,"timeStamp":1409056612709},{"bAE7":5.81,"timeStamp":1409056656681},{"bAE7":63.078,"timeStamp":1409056841896},{"bAE7":38.872,"timeStamp":1409056843328},{"bAE7":23.278,"timeStamp":1409056844729},{"bAE7":3.269,"timeStamp":1409056876237},{"bAE7":18.474,"timeStamp":1409057383907},{"bAE7":22.077,"timeStamp":1409057631534},{"bAE7":4.752,"timeStamp":1409057713854},{"bAE7":33.015,"timeStamp":1409057792450},{"bAE7":9.171,"timeStamp":1409057796662},{"bAE7":17.617,"timeStamp":1409058228042},{"bAE7":56.295,"timeStamp":1409058270707},{"bAE7":22.223,"timeStamp":1409058341672},{"bAE7":6.764,"timeStamp":1409058351263},{"bAE7":9.451,"timeStamp":1409058518864},{"bAE7":4.802,"timeStamp":1409058520215},{"bAE7":9.142,"timeStamp":1409058721278},{"bAE7":6.509,"timeStamp":1409058801011},{"bAE7":10.658,"timeStamp":1409058936465},{"bAE7":6.009,"timeStamp":1409058957572},{"bAE7":5.155,"timeStamp":1409059424547},{"bAE7":13.081,"timeStamp":1409059450472},{"bAE7":9.016,"timeStamp":1409059487477},{"bAAB":22.663,"timeStamp":1409059592074},{"bAAB":6.665,"timeStamp":1409059611091},{"bAAB":67.963,"timeStamp":1409059732086},{"bB2F":5.583,"timeStamp":1409059747985},{"bB2F":4.841,"timeStamp":1409059753244},{"bB2F":3.638,"timeStamp":1409059756064},{"bB2F":3.716,"timeStamp":1409059761136},{"bB2F":6.514,"timeStamp":1409059772958},{"bB2F":5.483,"timeStamp":1409059775889},{"bB6E":53.504,"bB2F":20.504,"bB64":14.504,"bB52":49.377,"timeStamp":1409059798933},{"bB64":4.572,"timeStamp":1409059805437},{"bB64":8.576,"timeStamp":1409059811989},{"bB64":4.748,"timeStamp":1409059815165},{"bB2F":4.529,"timeStamp":1409059817942},{"bB64":6.313,"timeStamp":1409059822848},{"bB64":8.626,"bB52":10.626,"timeStamp":1409059830414},{"bB64":5.364,"timeStamp":1409059834802},{"bB64":4.505,"timeStamp":1409059844924},{"bB6E":5.427,"bB64":6.427,"timeStamp":1409059849849},{"bB2F":6.209,"bB64":3.209,"timeStamp":1409059851622},{"bB64":5.806,"timeStamp":1409059863610},{"bB64":3.556,"timeStamp":1409059867963},{"bAAB":8.012,"timeStamp":1409059878705},{"bB64":6.842,"timeStamp":1409059881032},{"bB64":6.123,"timeStamp":1409059882533},{"bB64":3.983,"bB52":4.983,"bAAB":6.983,"timeStamp":1409059885395},{"bB64":7.202,"timeStamp":1409059895978},{"bB2F":7.17,"bB64":8.17,"bAAB":21.17,"timeStamp":1409059902592},{"bB64":11.249,"timeStamp":1409059909663},{"bB64":7.092,"timeStamp":1409059917499},{"b8F0":4.088,"bB64":10.088,"timeStamp":1409059927671},{"b8F0":5.103,"timeStamp":1409059931504},{"b8F0":6.088,"timeStamp":1409059941490},{"bB6E":6.076,"b8F0":7.076,"bB52":7.076,"timeStamp":1409059949477},{"bB52":5.091,"timeStamp":1409059961580},{"bB2F":9.082,"timeStamp":1409059971477},{"bB52":6.738,"timeStamp":1409059988244},{"bB52":4.41,"timeStamp":1409059990744},{"bB52":2.401,"timeStamp":1409059997802},{"bB52":3.009,"timeStamp":1409060007751},{"bB2F":4.931,"timeStamp":1409060013336},{"bB2F":5.047,"timeStamp":1409060019442},{"bB52":5.67,"timeStamp":1409060024084},{"bB2F":6.42,"bB52":5.42,"timeStamp":1409060026810},{"bA09":10.968,"timeStamp":1409060034488},{"bA09":4.095,"timeStamp":1409060036488},{"bB6E":8.095,"bA09":8.095,"timeStamp":1409060050486},{"bA09":5.078,"timeStamp":1409060054829},{"bA09":4.079,"timeStamp":1409060056470},{"bB52":8.1,"timeStamp":1409060065499},{"bA09":3.111,"timeStamp":1409060067517},{"bB52":5.104,"timeStamp":1409060069840},{"bB52":7.12,"bA09":5.12,"timeStamp":1409060074498},{"bB2F":12.09,"bB52":5.09,"bA09":6.09,"timeStamp":1409060084857},{"bB2F":3.106,"bB52":4.106,"timeStamp":1409060086506},{"bB52":6.1,"bA09":2.1,"timeStamp":1409060092504},{"bA09":4.127,"timeStamp":1409060098510},{"bB2F":7.389,"timeStamp":1409060102193},{"bB52":5.555,"timeStamp":1409060104953},{"bA09":5.681,"timeStamp":1409060109074},{"bA09":4.543,"timeStamp":1409060114942},{"bB52":9.188,"bA09":4.188,"timeStamp":1409060129980},{"bB2F":4.329,"timeStamp":1409060132725},{"bA09":4.113,"timeStamp":1409060138518},{"bB6E":4.739,"bB52":7.739,"timeStamp":1409060146154},{"bB52":4.664,"bA09":3.664,"timeStamp":1409060149422},{"bB2F":11.622,"bB52":5.622,"timeStamp":1409060161030},{"bB52":5.472,"bA09":2.472,"timeStamp":1409060166882},{"bB52":5.593,"timeStamp":1409060170988},{"bB52":3.312,"bA09":4.312,"timeStamp":1409060175709},{"bA09":4.176,"timeStamp":1409060181561},{"bB52":6.292,"timeStamp":1409060185691},{"bB52":10.108,"bA09":7.108,"timeStamp":1409060191514},{"bB2F":16.545,"bA09":4.545,"timeStamp":1409060192948},{"bB2F":3.741,"bA09":2.741,"timeStamp":1409060200653},{"bA09":3.976,"timeStamp":1409060203373},{"bA09":9.744,"timeStamp":1409060214150},{"bA09":4.509,"timeStamp":1409060216907},{"bB2F":4.896,"timeStamp":1409060229294},{"bA09":6.026,"timeStamp":1409060233424},{"bAE7":11.448,"timeStamp":1409060239912},{"bA09":5.276,"timeStamp":1409060242679},{"bB6E":5.354,"timeStamp":1409060245753},{"bA09":5.261,"timeStamp":1409060248664},{"bA09":7.792,"timeStamp":1409060255197},{"bA09":7.296,"timeStamp":1409060270709},{"bA09":6.328,"timeStamp":1409060286746},{"bA09":7.026,"timeStamp":1409060291425},{"bB2F":4.635,"bA09":6.635,"timeStamp":1409060296048},{"bA09":5.784,"timeStamp":1409060305562},{"bB2F":3.772,"timeStamp":1409060321970},{"bA09":3.251,"timeStamp":1409060327667},{"bA09":6.517,"timeStamp":1409060333923},{"bA09":9.173,"timeStamp":1409060338606},{"bB6E":8.47,"timeStamp":1409060347868},{"bB2F":5.329,"timeStamp":1409060350718},{"bA09":10.03,"timeStamp":1409060379423},{"bA09":3.827,"timeStamp":1409060382226},{"bB2F":5.843,"bA09":2.843,"timeStamp":1409060388241},{"bA09":6.624,"timeStamp":1409060398378},{"bB2F":6.249,"bA09":5.249,"timeStamp":1409060402643},{"bA09":6.015,"timeStamp":1409060411422},{"bA09":5.609,"timeStamp":1409060416020},{"bA09":10.875,"bAE7":15.875,"timeStamp":1409060428290},{"bA09":3.281,"timeStamp":1409060435671},{"bA09":7.25,"timeStamp":1409060442664},{"bB6E":5.688,"bA09":4.688,"timeStamp":1409060444118},{"bA09":13.816,"timeStamp":1409060461578},{"bA09":6.879,"timeStamp":1409060467271},{"bB2F":6.035,"timeStamp":1409060475432},{"bA09":6.069,"bAAB":10.069,"timeStamp":1409060494917},{"bB2F":4.99,"bA09":5.99,"timeStamp":1409060496388},{"bAAB":4.85,"timeStamp":1409060499267},{"bA09":8.569,"bAAB":10.569,"timeStamp":1409060509967},{"bAAB":6.587,"bAE7":37.587,"timeStamp":1409060516008},{"b8F0":13.197,"b892":13.197,"bAAB":7.197,"bAE7":11.197,"timeStamp":1409060522624},{"b8F0":5.869,"timeStamp":1409060530267},{"b8F0":6.322,"b892":7.322,"bA09":13.322,"timeStamp":1409060536735},{"bB6E":4.886,"b8F0":5.886,"timeStamp":1409060542296},{"b8F0":5.108,"b892":5.108,"bA09":9.108,"timeStamp":1409060553531},{"b8F0":5.343,"bA09":11.343,"timeStamp":1409060557749},{"b8F0":5.359,"b892":4.359,"timeStamp":1409060562906},{"b8F0":5.093,"b892":8.093,"timeStamp":1409060568496},{"b892":4.562,"timeStamp":1409060570549},{"bB2F":6.344,"b892":5.344,"timeStamp":1409060573759},{"b892":2.422,"timeStamp":1409060576817},{"bB2F":7.329,"timeStamp":1409060591108},{"b8F0":6.329,"timeStamp":1409060592742},{"bB2F":4.829,"timeStamp":1409060594247},{"bB2F":4.688,"b8F0":11.688,"timeStamp":1409060600103},{"bB2F":3.235,"timeStamp":1409060606629},{"bB2F":8.782,"b892":7.782,"bAE7":6.782,"timeStamp":1409060617390},{"bB2F":4.798,"b892":3.798,"timeStamp":1409060620188},{"bB2F":9.986,"b8F0":7.986,"timeStamp":1409060632843},{"bB2F":5.22,"timeStamp":1409060636490},{"bB6E":3.814,"b8F0":3.814,"timeStamp":1409060640226},{"b8F0":7.798,"timeStamp":1409060650413},{"b8F0":4.439,"timeStamp":1409060651848},{"b8F0":5.595,"timeStamp":1409060656001},{"b8F0":5.222,"bAAB":4.222,"timeStamp":1409060662637},{"b8F0":8.429,"bAAB":4.429,"timeStamp":1409060679834},{"b8F0":3.429,"bAAB":4.429,"timeStamp":1409060684837},{"b8F0":5.915,"bAAB":8.915,"timeStamp":1409060698276},{"b8F0":5.339,"timeStamp":1409060699742},{"bAAB":9.606,"timeStamp":1409060715546},{"bAAB":4.559,"timeStamp":1409060716964},{"b8F0":5.106,"timeStamp":1409060729498},{"bAAB":8.919,"timeStamp":1409060732712},{"bB2F":4.825,"timeStamp":1409060734238},{"bB6E":9.28,"b8F0":6.28,"timeStamp":1409060744716},{"b8F0":4.499,"bAAB":12.499,"timeStamp":1409060760906},{"bB2F":3.812,"timeStamp":1409060768211},{"bB2F":6.532,"b8F0":7.532,"timeStamp":1409060777948},{"b8F0":5.595,"timeStamp":1409060780987},{"b8F0":4.829,"timeStamp":1409060785224},{"b8F0":8.696,"timeStamp":1409060791088},{"bB2F":4.289,"timeStamp":1409060795131},{"bB2F":4.946,"b8F0":14.883,"timeStamp":1409060799354},{"bB2F":6.009,"timeStamp":1409060810404},{"bB2F":6.634,"timeStamp":1409060816027},{"bB2F":8.462,"timeStamp":1409060823272},{"bB2F":3.29,"timeStamp":1409060832677},{"bB6E":6.947,"timeStamp":1409060841765},{"bB2F":6.587,"bAAB":9.587,"timeStamp":1409060857511},{"bB2F":11.681,"bAE7":23.554,"timeStamp":1409060872099},{"bB2F":10.869,"timeStamp":1409060876254},{"bAE7":6.525,"timeStamp":1409060920979},{"bB6E":4.464,"timeStamp":1409060937841},{"bB2F":4.433,"bAAB":5.433,"timeStamp":1409060946839},{"bAAB":6.48,"timeStamp":1409060952880},{"bB2F":6.665,"bAAB":5.792,"timeStamp":1409060956197},{"bAAB":7.073,"timeStamp":1409060963461},{"bAAB":7.995,"timeStamp":1409060971378},{"bAAB":7.793,"timeStamp":1409060994174},{"bAAB":5.871,"timeStamp":1409060997256},{"bAAB":4.824,"timeStamp":1409061000196},{"bAAB":3.824,"timeStamp":1409061003206},{"bB6E":7.325,"timeStamp":1409061040248},{"bB55":18.107,"timeStamp":1409061088906},{"bB55":20.779,"timeStamp":1409061093153},{"b8F0":16.262,"timeStamp":1409061103769},{"b8F0":3.185,"timeStamp":1409061106931},{"b8F0":4.529,"timeStamp":1409061112916},{"b8F0":3.373,"bB55":13.373,"timeStamp":1409061125180},{"bB55":8.154,"timeStamp":1409061135101},{"b8F0":3.201,"bB55":6.201,"timeStamp":1409061136632},{"bB6E":8.248,"timeStamp":1409061141090},{"bB55":6.858,"timeStamp":1409061144280},{"b8F0":5.842,"bAE7":2.842,"timeStamp":1409061153261},{"b8F0":4.467,"timeStamp":1409061154851},{"b8F0":3.029,"timeStamp":1409061180452},{"bB55":5.997,"timeStamp":1409061187410},{"b8F0":20.892,"bAE7":6.829,"timeStamp":1409061199586},{"bB55":2.784,"timeStamp":1409061205191},{"bA09":4.472,"bAAB":9.472,"timeStamp":1409061212889},{"bAAB":4.988,"timeStamp":1409061214409},{"bAAB":5.222,"timeStamp":1409061218025},{"bA09":3.8,"bAAB":4.8,"timeStamp":1409061222217},{"bA09":5.551,"bAAB":7.551,"timeStamp":1409061231300},{"bA09":2.395,"bAAB":4.395,"bB55":3.395,"timeStamp":1409061232792},{"bB6E":5.286,"timeStamp":1409061235687},{"bAAB":7.036,"bB55":3.036,"timeStamp":1409061238428},{"b8F0":9.88,"bA09":4.88,"timeStamp":1409061245290},{"b8F0":5.882,"bB55":4.882,"timeStamp":1409061250287},{"bB55":5.116,"timeStamp":1409061254505},{"b8F0":6.476,"bAAB":6.476,"bB55":8.476,"timeStamp":1409061261873},{"bAAB":5.617,"timeStamp":1409061265014},{"bAAB":7.433,"timeStamp":1409061283847},{"b8F0":4.466,"bA09":5.466,"timeStamp":1409061296217},{"b8F0":3.044,"timeStamp":1409061300434},{"bA09":8.469,"bB55":14.469,"timeStamp":1409061309883},{"b8F0":4.001,"timeStamp":1409061311447},{"bA09":3.942,"timeStamp":1409061314877},{"bA09":4.273,"bB55":3.273,"timeStamp":1409061319746},{"b8F0":7.318,"bA09":5.318,"timeStamp":1409061327147},{"bB55":5.334,"timeStamp":1409061331744},{"bB6E":11.781,"bA09":6.781,"timeStamp":1409061341190},{"b8F0":3.219,"bA09":4.219,"bB55":6.219,"timeStamp":1409061342679},{"b8F0":3.969,"timeStamp":1409061346356},{"bA09":5.176,"timeStamp":1409061352598},{"bA09":8.824,"timeStamp":1409061360631},{"b8F0":3.679,"bA09":9.679,"bAAB":6.679,"bB55":5.679,"timeStamp":1409061362137},{"bB55":4.633,"timeStamp":1409061365030},{"bB55":5.856,"timeStamp":1409061373276},{"b8F0":5.58,"bB55":8.58,"timeStamp":1409061380984},{"b8F0":4.351,"timeStamp":1409061383754},{"b8F0":7.766,"bA09":2.766,"timeStamp":1409061391171},{"bB6E":7.983,"timeStamp":1409061398863},{"bA09":4.393,"bB55":6.393,"timeStamp":1409061405788},{"bB55":4.508,"timeStamp":1409061414894},{"bA09":8.622,"timeStamp":1409061424007},{"bA09":2.748,"bB55":3.748,"timeStamp":1409061430150},{"bA09":7.726,"timeStamp":1409061438143},{"bA09":3.181,"bB55":3.181,"timeStamp":1409061441381},{"bA09":4.46,"bB55":4.46,"timeStamp":1409061445854},{"bA09":3.177,"bAAB":5.177,"timeStamp":1409061467567},{"bA09":4.137,"bAAB":5.137,"timeStamp":1409061474226},{"bAAB":3.637,"timeStamp":1409061477025},{"bAAB":3.472,"bB55":5.472,"timeStamp":1409061487208},{"bAAB":4.525,"timeStamp":1409061491961},{"bAAB":8.702,"timeStamp":1409061500089},{"bB55":5.108,"timeStamp":1409061501485},{"bB55":12.353,"timeStamp":1409061517739},{"bB55":5.15,"timeStamp":1409061520533},{"bB55":4.905,"timeStamp":1409061523287},{"bAAB":7.377,"bB55":8.377,"timeStamp":1409061530776},{"bAAB":8.261,"bB55":3.261,"timeStamp":1409061538654},{"bA09":9.665,"timeStamp":1409061548033},{"bB55":2.214,"timeStamp":1409061553598},{"bB46":19.6,"bA09":7.727,"timeStamp":1409061562125},{"bA09":4.508,"bB55":7.508,"timeStamp":1409061564901},{"bA09":3.437,"timeStamp":1409061569830},{"bB46":4.952,"bA09":6.079,"timeStamp":1409061580460},{"bA09":9.251,"timeStamp":1409061590646},{"bA09":5.936,"timeStamp":1409061599320},{"bA09":3.763,"timeStamp":1409061605148},{"bA09":3.59,"timeStamp":1409061613965},{"bA09":4.535,"timeStamp":1409061620915},{"bB46":22.378,"bA09":4.505,"timeStamp":1409061627886},{"bA09":4.671,"timeStamp":1409061637052},{"bB46":12.759,"bAAB":22.886,"timeStamp":1409061645638},{"bA09":3.995,"timeStamp":1409061651403},{"b882":6.928,"bA09":7.928,"timeStamp":1409061659320},{"b882":5.137,"bA09":6.137,"timeStamp":1409061667913},{"bB46":14.863,"bA09":10.99,"timeStamp":1409061677737},{"bA09":2.481,"timeStamp":1409061683873},{"bB46":14.23,"timeStamp":1409061707734},{"bB46":5.621,"bA09":2.748,"timeStamp":1409061709141},{"b882":7.441,"bA09":9.441,"bAAB":5.441,"timeStamp":1409061723820},{"b882":2.981,"bA09":4.981,"bAAB":2.981,"timeStamp":1409061726164},{"bA09":2.121,"timeStamp":1409061732508},{"bAAB":7.08,"timeStamp":1409061740452},{"bA09":6.411,"timeStamp":1409061743797},{"bAAB":4.802,"timeStamp":1409061745176},{"bB46":21.036,"b882":9.163,"bA09":5.163,"timeStamp":1409061754549},{"bA09":3.091,"bAAB":15.091,"timeStamp":1409061763474},{"b882":3.405,"bA09":5.405,"timeStamp":1409061774777},{"b882":4.614,"bA09":5.614,"timeStamp":1409061778994},{"b882":3.725,"bA09":5.725,"timeStamp":1409061791486},{"b882":10.538,"bAAB":6.538,"timeStamp":1409061802287},{"b882":4.698,"timeStamp":1409061805069},{"bAAB":11.886,"timeStamp":1409061809275},{"bB46":13.728,"timeStamp":1409061816253},{"b882":4.574,"timeStamp":1409061821325},{"b882":8.394,"timeStamp":1409061833811},{"b882":3.847,"timeStamp":1409061835225},{"bB46":18.48,"b882":8.607,"timeStamp":1409061849000},{"b882":5.013,"timeStamp":1409061850388},{"b882":4.533,"timeStamp":1409061853914},{"b882":4.769,"timeStamp":1409061858140},{"b882":6.909,"timeStamp":1409061866288},{"bB46":8.822,"timeStamp":1409061878304},{"bB46":7.428,"bAAB":9.555,"timeStamp":1409061909926},{"bB46":8.404,"bAB5":8.531,"timeStamp":1409061941902},{"bAB5":4.89,"timeStamp":1409061943248},{"bAB5":8.609,"timeStamp":1409061947973},{"bB46":13.749,"bAAB":3.876,"timeStamp":1409061967248},{"bAAB":6.756,"timeStamp":1409061973123},{"bAAB":1.866,"timeStamp":1409061978207},{"bAAB":3.431,"timeStamp":1409061983833},{"bAB5":3.815,"bAAB":5.815,"timeStamp":1409061991186},{"bB46":18.48,"bAB5":5.607,"timeStamp":1409061999334},{"bAB5":4.797,"timeStamp":1409062008179},{"bAB5":3.269,"bAAB":4.269,"timeStamp":1409062023217},{"bAB5":4.661,"timeStamp":1409062026027},{"bB46":9.654,"timeStamp":1409062031163},{"bAB5":5.409,"bAAB":10.409,"timeStamp":1409062037774},{"bAAB":12.382,"timeStamp":1409062042767},{"bAB5":5.851,"timeStamp":1409062047235},{"bAB5":9.908,"timeStamp":1409062068274},{"bAB5":5.33,"timeStamp":1409062069701},{"bAB5":4.33,"timeStamp":1409062076182},{"bB46":60.41,"bAB5":3.537,"timeStamp":1409062105308},{"bB46":26.958,"timeStamp":1409062108289},{"b882":5.725,"timeStamp":1409062120098},{"b882":4.707,"timeStamp":1409062127086},{"bAB5":6.633,"bB56":11.506,"b882":6.633,"timeStamp":1409062133009},{"bAB5":4.478,"bB56":2.478,"timeStamp":1409062135851},{"bB46":2.28,"b882":3.407,"timeStamp":1409062139453},{"bAB5":10.683,"bB56":5.683,"b882":4.683,"timeStamp":1409062152062},{"bAB5":4.545,"b882":2.545,"timeStamp":1409062154923},{"bAB5":8.014,"timeStamp":1409062164382},{"bB46":8.907,"bB56":4.034,"b882":5.034,"timeStamp":1409062172414},{"bB46":9.894,"bB56":6.021,"b882":5.021,"timeStamp":1409062180396},{"bB56":3.88,"b882":3.88,"timeStamp":1409062183254},{"bAB5":5.314,"bB56":9.314,"b882":7.314,"timeStamp":1409062193700},{"bB56":4.384,"timeStamp":1409062196766},{"b882":4.792,"timeStamp":1409062200173},{"b882":6.593,"timeStamp":1409062202979},{"bB65":8.827,"bB46":20.7,"bB56":3.827,"timeStamp":1409062215209},{"bB65":2.678,"bAB5":3.678,"bB56":10.678,"bAE7":12.551,"timeStamp":1409062227051},{"bB65":2.475,"bAE7":5.475,"timeStamp":1409062229862},{"bB65":12.6,"bB46":18.473,"bAB5":5.6,"bB56":14.6,"bAAB":10.6,"timeStamp":1409062246416},{"bAB5":4.413,"bB56":6.413,"bAAB":5.413,"timeStamp":1409062247921},{"bB65":1.297,"bB56":5.297,"bAAB":4.297,"timeStamp":1409062250673},{"bAB5":5.075,"bB56":8.075,"bAAB":7.075,"timeStamp":1409062257448},{"bAB5":4.252,"bB56":4.252,"timeStamp":1409062262946},{"bAB5":9.793,"bAAB":6.793,"timeStamp":1409062276560},{"bAB5":2.997,"timeStamp":1409062279397},{"bAE7":42.932,"timeStamp":1409062282325},{"bB6E":13.986,"bAB5":7.113,"bAAB":8.113,"timeStamp":1409062287507},{"bAB5":4.16,"timeStamp":1409062290552},{"bB65":3.342,"timeStamp":1409062294084},{"bB46":16.678,"bAB5":6.805,"timeStamp":1409062308183},{"bB65":8.787,"timeStamp":1409062322168},{"bAB5":16.898,"timeStamp":1409062330286},{"bB46":12.602,"timeStamp":1409062338172},{"bB6E":7.448,"timeStamp":1409062357828},{"bB46":9.119,"timeStamp":1409062369615},{"bAE7":9.865,"timeStamp":1409062385230},{"bB46":13.394,"bAB5":17.521,"timeStamp":1409062400960},{"bAB5":5.162,"timeStamp":1409062402535},{"bAB5":3.037,"timeStamp":1409062405410},{"bAB5":5.444,"timeStamp":1409062419814},{"bB46":22.397,"bAB5":13.524,"timeStamp":1409062435901},{"bAB5":4.462,"timeStamp":1409062438828},{"bAB5":10.074,"timeStamp":1409062448456},{"bAB5":5.027,"timeStamp":1409062451398},{"bB46":11.226,"timeStamp":1409062465728},{"bAB5":4.439,"timeStamp":1409062472192},{"bAAB":6.25,"bAE7":5.25,"timeStamp":1409062479629},{"bAAB":4.605,"timeStamp":1409062485974},{"bB46":25.057,"bAAB":6.184,"timeStamp":1409062498562},{"bAAB":3.481,"timeStamp":1409062501860},{"bB65":142.035,"bAAB":5.035,"timeStamp":1409062512402},{"bB65":11.563,"bAAB":5.563,"timeStamp":1409062517300},{"bB65":9.181,"bB46":4.181,"timeStamp":1409062518704},{"bB6E":14.736,"bB46":6.736,"bAB5":5.863,"bAAB":6.863,"timeStamp":1409062528232},{"bB46":8.624,"bAB5":4.751,"timeStamp":1409062531104},{"bAAB":7.236,"timeStamp":1409062533630},{"bB65":18.146,"bAE7":47.146,"timeStamp":1409062551519},{"bAB5":12.299,"bAE7":14.236,"timeStamp":1409062561668},{"bB46":9.397,"timeStamp":1409062565893},{"bB65":23.758,"bB46":15.631,"bAB5":9.758,"timeStamp":1409062574130},{"bB65":4.971,"bAB5":4.971,"timeStamp":1409062578710},{"bB46":34.541,"timeStamp":1409062601049},{"bAB5":6.113,"timeStamp":1409062608479},{"bB65":4.938,"bAB5":6.938,"timeStamp":1409062627304}];
///////////////////////////////////////////////////////////////
  var vehicleIds = [];
  data.forEach(function(logs) {
    Object.keys(logs).forEach(function(key) {
       if (key!=="timeStamp" && key!="bAE7") {
           if (vehicleIds.indexOf(key) === -1) {
               vehicleIds.push(key);
           }
       } else if ( key ==="bAE7") {
           delete logs[key];
       }
    });
  });

  data = data.filter(function(logs) {
     return Object.keys(logs).length >1;
  });


  data.forEach(function(d) {
    d.date = new Date(d.timeStamp);
  });

  var analyzer = streamDataAnalizer({});

  data.forEach(function(logs) {
      var timestamp = logs.timeStamp,
      countLogs = 0;
      Object.keys(logs).filter(function(key) {
        return key !== "timeStamp" && key !== "date";
      }).forEach(function (key) {
          var delayTime = logs[key];
          countLogs++;
          analyzer.add(timestamp, delayTime);
      });
      var temp = new Date(timestamp);

      logs.count = countLogs;
      logs.avg  = analyzer.get(timestamp);
      logs.median = analyzer.getMed(timestamp);

  //    console.log(countLogs + "  " +   temp.getHours() + ":" + temp.getMinutes() + ":" +  temp.getSeconds(), logs.avg );
  });
  debugger;
  vehicleIds.push("avg","median", "count");

var color = d3.scale.category10();
color.domain(vehicleIds);
var vehicles = color.domain().map(function(name) {
  var vehicleData =  data.filter(function(logs) {
         return logs[name];
      });
  return {
    name: name,
    values: vehicleData.map(function(d) {
      return {date: d.date, delayTime: +d[name]};
    })
  };
});

//////////////////////////////////////////////////////////////////

var parseDate = d3.time.format("%Y%m%d").parse;

//************************************************************
// Create Margins and Axis and hook our zoom function
//************************************************************
var margin = {top: 20, right: 80, bottom: 30, left: 50},
    width = 1600 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var x = d3.time.scale()
  //  .domain([59592074,62627304])
    .range([0, width]);

var y = d3.scale.linear()
  //  .domain([0,100])
    .range([height, 0]);



x.domain(d3.extent(data, function(d) { return d.date;}));

y.domain([
  d3.min(vehicles, function(c) { return    d3.min(c.values, function(v) { return v.delayTime; }); }),
  d3.max(vehicles, function(c) { return d3.max(c.values, function(v) { return v.delayTime; }) ; })
]);
var xAxis = d3.svg.axis()
    .scale(x)
    .tickPadding(10)
	  .tickSubdivide(true)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .tickPadding(10)
	  .tickSize(-width)
	  .tickSubdivide(true)
    .orient("left");

var zoom = d3.behavior.zoom()
    .x(x)
    .y(y)
    .scaleExtent([1, 10])
    .on("zoom", zoomed);


var line = d3.svg.line()
    .interpolate("linear")
    .x(function(d) { return x(d.date); })
    .y(function(d) { return y(d.delayTime); });

var svg = d3.select("body").append("svg")
    .call(zoom)
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");






svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis);

svg.append("g")
    .attr("class", "y axis")
    .call(yAxis)
    .append("text")
    .attr("transform", "rotate(-90)")
    .attr("y", 6)
    .attr("dy", ".71em")
    .style("text-anchor", "end")
    .text("delayTime (s)");

    svg.append("clipPath")
      .attr("id", "clip")
      .append("rect")
      .attr("width", width)
      .attr("height", height);


  var vehicle = svg.selectAll(".vehicle")
      .data(vehicles)
      .enter().append("g")
      .attr("class", "vehicle");

  vehicle.append("path")
      .attr("clip-path", "url(#clip)")
      .attr("class", "line")
      .attr("d", function(d) { return line(d.values); })
      .style("stroke", function(d) { return color(d.name); })
      .attr("stroke-width", function(d)  { if (d.name[0] !== "b" && d.name !== "count" )  return 3; else return 1;});



var points = svg.selectAll('.dots')
  .data(vehicles)
  .enter()
  .append("g")
  .attr("class", "dots")
  .attr("clip-path", "url(#clip)");

  points.selectAll('.dot')
  .data(function (d) {
    var a = [];
    d.values.forEach(function(point,i){
      a.push({'index': d.name, 'point': point});
    });
    return a;
  })
  .enter()
  .append('circle')
  .attr('class','dot')
  .attr("r", 2.5)
  .attr("fill", function(d) { return color(d.index); })
  .attr("cx", function(d) { return x(d.point.date) })
  .attr("cy", function(d) {  return y(d.point.delayTime)})



var legendDiv = d3.select("body").append("div").attr("class", "legend");
  var p =  legendDiv.selectAll(".asd").data(color.domain())
             .enter()
             .append("p")
             .text(function(d) {return d;});


    var spans =  p.append("span").html("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;").style("background-color", function(d) {return color(d)});
    var checkboxes =  spans.insert("input").attr("type", "checkbox").attr("checked", true).on("click", function(d){
            var line =     svg.selectAll('path.line').filter(function(c) { return c.name === d}),
                pointGroup = points.filter(function(c) { return c.name === d});

            if (this.checked) {
                line.classed("dn", false);
                pointGroup.classed("dn", false);
            } else {
                line.classed("dn", true);
                pointGroup.classed("dn", true);
            }
        });
;
//************************************************************
// Zoom specific updates
//************************************************************
function zoomed() {
	svg.select(".x.axis").call(xAxis);
	svg.select(".y.axis").call(yAxis);
	svg.selectAll('path.line').attr("d", function(d) { return line(d.values); })
  points.selectAll("circle").attr("cx", function(d) { return x(d.point.date) })
  .attr("cy", function(d) {  return y(d.point.delayTime)});
}


</script>
